{% include "cotravelling/base.html" %}

<div style="height:1em;"></div>

{% if forbidden %}
    <h1>Чтобы увидеть чат, нужно присоединиться к поездке.</h1>
{% else %}

<div class="w-100 p-3">
<div class="row">
    <div class="col", style="width:70%">
        <div class="container">
            {% for message in messages %}
            {% if message.author == request.user %}
            <div class="row justify-content-end">
            {% else %}
            <div class="row justify-content-start">
            {% endif %}
                <div class="col-xs-4" style="margin-top: 1em">
                    {% if message.author != request.user %}
                    {{message.author_info}}:
                    {% endif %}
                    <div class="alert alert-primary" role="alert" style="margin-bottom: 0">
                        {{message.text}}
                    </div>
                    <small>{{message.datetime}}</small>
                </div>
            </div>
            {% endfor %}
            <div style="height:5em;"></div>
        </div>
    </div>
    <div class="col"">
        <table class="table" style="background-color:#DDF0FF">
            <tr>
            <td>Когда</td><td> {{trip_info.datetime}}</td>
            </tr>
            <tr>
            <td>Куда:</td><td> {{trip_info.target}}</td>
            </tr>
            <tr>
            <td>Кто: </td><td>
            {% for user in participants %}
            {{user.first_name}} {{user.last_name}}</br>
            {% endfor %}
            </td>
            </tr>
        </table>
    </div>
</div>
</div>

<div class="fixed-bottom" style="background-color: #eee;height:5em;">
    <form action="{{ request.get_full_path }}" method="post" autocomplete="off">
        {% csrf_token %}
        <div class="w-100 p-3">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col">
                        <input type="text" name="text" placeholder="Напишите сообщение" class="md-textarea form-control" maxlength=200></textarea>
                    </div>
                    <div class="col">
                        <button type="submit" class="btn btn-primary">Отправить</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

{% endif %}
